---
interface Props {
  id: string;
  images: string[];
}

const { id, images } = Astro.props;
let currentIndex = 0;
---

<style>
  .carousel {
    position: relative;
    width: 100%;
    height: 350px;
    margin: auto;
  }

  .carousel img {
    height: 0;
    width: 0;
    max-height: 350px;
    opacity: 0;
    transition: opacity 0.7s ease-out;
  }

  .carousel img.active {
    width: 100%;
    height: 350px;
    opacity: 1;
    object-fit: contain;
  }

  .controls {
    position: absolute;
    top: 50%;
    width: calc(100% + 1.6rem);
    left: -0.8rem;
    display: flex;
    justify-content: space-between;
    transform: translateY(-50%);
  }

  .controls button {
    transition: 0.3s ease-out;
    background-color: var(--background);
    border: solid 1px var(--text);
    cursor: pointer;
    display: inline-flex;
    justify-content: center;
    align-items: center;
    border-radius: 3px;
    height: 35px;
    width: 30px;
  }

  .controls svg {
    height: 20px;
    width: 20px;
  }

  .controls path {
    transition: 0.2s ease-out;
    color: var(--text);
  }

  .controls button:hover {
    background-color: var(--text);
  }

  .carousel button:hover path {
    color: var(--accent);
  }
</style>

<div class="carousel">
  {
    images.map((image, index) => (
      <img src={image} class={index === 0 ? "active" : ""} />
    ))
  }
  <div class="controls">
    <button id="prev" onclick="showImage(currentIndex - 1)">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="ionicon"
        viewBox="0 0 512 512"
        ><path
          fill="none"
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="80"
          d="M328 112L184 256l144 144"></path></svg
      >
    </button>
    <button onclick="showImage(currentIndex + 1)"
      ><svg
        xmlns="http://www.w3.org/2000/svg"
        class="ionicon"
        viewBox="0 0 512 512"
        ><path
          fill="none"
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="80"
          d="M184 112l144 144-144 144"></path></svg
      ></button
    >
  </div>
</div>

<script is:inline>
  const images = document.querySelectorAll(`#${id} img`);

  function showImage(index) {
    images[currentIndex].classList.remove("active");
    currentIndex = (index + images.length) % images.length;
    images[currentIndex].classList.add("active");
  }
</script>
